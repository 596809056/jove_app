<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../css/biaodan.css" />
		<link rel="stylesheet" type="text/css" href="../js/layui/css/layui.css">
		<script type="text/javascript" src="../js/jquery-3.4.1.js"></script>
		<script type="text/javascript" src="../js/layui/layui.all.js"></script>
		<script src="../js/mui.min.js"></script>
		<script src="../js/mui.picker.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../css/mui.picker.min.css" />
		<script src="../js/app.js"></script>
	</head>
	<style type="text/css">
		#upperTime,
		#lowerTime,
		#signTime {
			height: 40px;
			line-height: 10px;
		}

		#jianYan {
			text-align: center;
			padding: 5px;
			color: darkslategrey;
		}

		.title-text span {
			display: block;
			position: relative;
			text-align: left;
		}

		.title-text span:before,
		.title-text span:after {
			content: '';
			position: absolute;
			top: 50%;
			background: red;
			width: 70%;
			height: 1px;
		}

		.title-text span:before {
			left: 20%;
		}

		.title-text span:after {
			right: -1%;
		}
	</style>
	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">中富移动办公</h1>
		</header>
		<div class="mui-content">
			<div id="hcaption">
				钻孔生产日报
			</div>
			<ul class="mui-list-unstyled mui-table-view biaodan" style="margin-top: 0;">
				<li class="mui-table-view-cell mui-collapse mui-active" style="color: cadetblue;text-align: left;padding: 0.5rem 1rem;">
					<a class="mui-navigate-right" href="#">条码信息</a>
					<div class="mui-collapse-content tiaoMa">
						<p><input id="code" type="text" value="  -511911-05-00" data-id="tiaoma1" placeholder="点击扫描" /></p>
					</div>
					<div class="mui-collapse-content tiaoMa">
						<p><input id="barcode" type="text" class="scan" value="" data-id="tiaoma" placeholder="轻触以打开扫描" readonly="readonly" /></p>
					</div>
				</li>
				
				<li class="mui-table-view-cell mui-collapse" style="color: royalblue;text-align: left;padding:0.5rem 1rem;">
					<a class="mui-navigate-right" href="#">基础数据</a>
					<div class="mui-collapse-content">
						<p class="mui-row jichushuju">
							<span class="mui-col-xs-3">厂别:</span>
							<span class="mui-col-xs-9"><input id="factoryName" name="factoryName" type="text" value="" readonly /></span>
						</p>
						<p class="mui-row jichushuju">
							<span class="mui-col-xs-3">MO号:</span>
							<span class="mui-col-xs-9"><input id="mo" name="mo" class="reset" type="text" value="" readonly /></span>
						</p>
						<p class="mui-row jichushuju">
							<span class="mui-col-xs-3">生产编码:</span>
							<span class="mui-col-xs-9"><input id="mfg" name="mfg" class="reset" type="text" value="" readonly /></span>
						</p>
						<p class="mui-row jichushuju">
							<span class="mui-col-xs-3">工单号:</span>
							<span class="mui-col-xs-9"><input id="wo" name="wo" class="reset" type="text" value="" readonly /></span>
						</p>
						<p class="mui-row jichushuju">
							<span class="mui-col-xs-3">客户代码:</span>
							<span class="mui-col-xs-9"><input id="custcode" name="custcode" class="reset" type="text" value="" readonly /></span>
						</p>
						<p class="mui-row jichushuju">
							<span class="mui-col-xs-3">客户型号:</span>
							<span class="mui-col-xs-9"><input id="custpart" name="custpart" class="reset" type="text" value="" readonly /></span>
						</p>
						<p class="mui-row jichushuju">
							<span class="mui-col-xs-3">LOT号:</span>
							<span class="mui-col-xs-9"><input id="lot" name="lot" class="reset" type="text" value="N/A" readonly /></span>
						</p>
						<p class="mui-row jichushuju">
							<span class="mui-col-xs-3">周期:</span>
							<span class="mui-col-xs-9"><input id="datecode" name="datecode" class="reset" type="text" value="N/A" readonly /></span>
						</p>
						<p class="mui-row jichushuju" style="display: none;">
							<span class="mui-col-xs-3">d06rkey:</span>
							<span class="mui-col-xs-9"><input id="d06rkey" name="d06rkey" class="reset" type="text" value="" readonly /></span>
						</p>
					</div>
				</li>
				<div id="test">
			<div class="layui-inline">
			<label class="layui-form-label">班别</label>
				<div class="layui-input-inline">
					<input type="text" id="class" 
						autocomplete="off" class="layui-input">
				</div>
			</div>
			<div class="layui-inline">
			<label class="layui-form-label">操作员</label>
				<div class="layui-input-inline">
					<input type="text" id="operator" 
						autocomplete="off" class="layui-input">
				</div>
			</div>
			<div class="layui-inline">
			<label class="layui-form-label">机台号</label>
				<div class="layui-input-inline">
					<input type="text" id="machineNo" 
						autocomplete="off" class="layui-input">
				</div>
			</div>
				<li class="mui-table-view-cell mui-collapse mui-active" style="color: coral;text-align: left;padding:0.5rem 1rem;">
					<a class="mui-navigate-right" href="#">实测数据</a>
					<div class="mui-collapse-content" id="test">
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">机台号:</span>
							<span class="mui-col-xs-9"><input id="machineNo1" name="machineNo" class="reset" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">班别:</span>
							<span class="mui-col-xs-9"><input id="class1" name="class" class="reset" type="text" value="" /></span>
						</p>

						<div id="jianYan">
							<p class="title-text"><span>主轴叠板数</span></p>
						</div>

						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">主叠板数1:</span>
							<span class="mui-col-xs-9"><input id="laminatea1" name="laminatea" class="reset calc" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">主叠板数2:</span>
							<span class="mui-col-xs-9"><input id="laminateb1" name="laminateb" class="reset calc" type="text" value="" /></span>
						</p>

						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">主叠板数3:</span>
							<span class="mui-col-xs-9"><input id="laminatec1" name="laminatec" class="reset calc" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">主叠板数4:</span>
							<span class="mui-col-xs-9"><input id="laminated1" name="laminated" class="reset calc" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">主叠板数5:</span>
							<span class="mui-col-xs-9"><input id="laminatee1" name="laminatee" class="reset calc" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">主叠板数6:</span>
							<span class="mui-col-xs-9"><input id="laminatef1" name="laminatef" class="reset calc" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju" style="padding: 40px 0px 0px 0px;">
							<span class="mui-col-xs-3">总孔数:</span>
							<span class="mui-col-xs-9"><input id="totalHoleNo1" name="totalHoleNo" class="reset" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">特殊孔数:</span>
							<span class="mui-col-xs-9"><input id="specHoleNo1" name"specHoleNo" class="reset" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">最小孔径:</span>
							<span class="mui-col-xs-9"><input id="minHoleDia1" name="minHoleDia" class="reset minHoleDia" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">板厚:</span>
							<span class="mui-col-xs-9"><input id="plateThick1" name="plateThick" class="reset plateThick" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">总片数:</span>
							<span class="mui-col-xs-9"><input id="totalNum1" name="totalNum" class="reset" type="text" value="0"  style="cursor:not-allowed;background-color: #EEEEEE" disabled="disabled"/></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">上板时间:</span>
							<span class="mui-col-xs-9"><button id="upperTime1" name="upperTime" class="btn mui-btn mui-btn-block"></button></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">下板时间:</span>
							<span class="mui-col-xs-9"><button id="lowerTime1" name="lowerTime" class="btn mui-btn mui-btn-block"></button></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">首件确认:</span>
							<span class="mui-col-xs-9"><input id="fisrtConfirm1" name="fisrtConfirm" class="reset" type="text" value="" /></span>
						</p>
						<p class="mui-row shiceshuju">
							<span class="mui-col-xs-3">底板检验状况:</span>
							<span class="mui-col-xs-9"><input id="checkResult1" name="checkResult" class="reset" type="text" value="" /></span>
						</p>
						<p class="mui-row ">
							<span class="mui-col-xs-3">操作人:</span>
							<span class="mui-col-xs-9"><input id="operator1" name="operator" type="text" value="" /></span>
						</p>
						<p class="mui-row ">
							<span class="mui-col-xs-3">备注:</span>
							<span class="mui-col-xs-9"><input id="remark1" name="remark1" type="text" value="" /></span>
						</p>
						<p class="mui-row " style="display: none;">
							<span class="mui-col-xs-9"><input id="auditor1" name="operator" type="text" value="" /></span>
					    </p>
					</div>
				</li>
				</div>
				<input type="button" class="mui-btn mui-btn-blue mui-btn-outlined" value="点击添加输入框"
					id="add" />
				<input type="button" class="mui-btn mui-btn-red mui-btn-outlined" value="点击清除输入框"
					id="remove" />
			</ul>
			<ul class="mui-list-inline" style="text-align: center;">
				<li><button id="submit" type="button" class="mui-btn mui-btn-blue mui-btn-outlined" style="background-color: #009688;color: #fff;border-radius: 2px;">提交</button></li>
				<li><button id="reset" type="button" class="mui-btn mui-btn-blue mui-btn-outlined">重置</button></li>
			</ul>
		</div>
	</body>

	<script type="text/javascript">
		var i = 2;
$(function(){ 
	  $("#add").click(function(){
	    $("#test").append(
	    				'<li id="t'+i+'" class="mui-table-view-cell mui-collapse mui-active" style="color: coral;text-align: left;padding:0.5rem 1rem;">'+
						'<a class="mui-navigate-right" href="#">实测数据</a>'+
						'<div class="mui-collapse-content">'+
	    				'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">机台号:</span>'+
							'<span class="mui-col-xs-9"><input id="machineNo'+i+'" class="reset" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">班别:</span>'+
							'<span class="mui-col-xs-9"><input id="class'+i+'" class="reset" type="text" value="" /></span>'+
						'</p>'+

						'<div id="jianYan">'+
							'<p class="title-text"><span>主轴叠板数</span></p>'+
						'</div>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">主叠板数1:</span>'+
							'<span class="mui-col-xs-9"><input id="laminatea'+i+'" class="reset calc'+i+'" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">主叠板数2:</span>'+
							'<span class="mui-col-xs-9"><input id="laminateb'+i+'" class="reset calc'+i+'" type="text" value="" /></span>'+
						'</p>'+

						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">主叠板数3:</span>'+
							'<span class="mui-col-xs-9"><input id="laminatec'+i+'" class="reset calc'+i+'" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">主叠板数4:</span>'+
							'<span class="mui-col-xs-9"><input id="laminated'+i+'" class="reset calc'+i+'" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">主叠板数5:</span>'+
							'<span class="mui-col-xs-9"><input id="laminatee'+i+'" class="reset calc'+i+'" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">主叠板数6:</span>'+
							'<span class="mui-col-xs-9"><input id="laminatef'+i+'" class="reset calc'+i+'" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju" style="padding: 40px 0px 0px 0px;">'+
							'<span class="mui-col-xs-3">总孔数:</span>'+
							'<span class="mui-col-xs-9"><input id="totalHoleNo'+i+'" class="reset" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">特殊孔数:</span>'+
							'<span class="mui-col-xs-9"><input id="specHoleNo'+i+'" class="reset" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">最小孔径:</span>'+
							'<span class="mui-col-xs-9"><input id="minHoleDia'+i+'" class="reset minHoleDia" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">板厚:</span>'+
							'<span class="mui-col-xs-9"><input id="plateThick'+i+'" class="reset plateThick" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">总片数:</span>'+
							'<span class="mui-col-xs-9"><input id="totalNum'+i+'" class="reset" type="text" value="0"  style="cursor:not-allowed;background-color: #EEEEEE" disabled="disabled"/></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">上板时间:</span>'+
							'<span class="mui-col-xs-9"><button id="upperTime'+i+'" class="btn mui-btn mui-btn-block"></button></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">下板时间:</span>'+
							'<span class="mui-col-xs-9"><button id="lowerTime'+i+'" class="btn mui-btn mui-btn-block"></button></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">首件确认:</span>'+
							'<span class="mui-col-xs-9"><input id="fisrtConfirm'+i+'" class="reset" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row shiceshuju">'+
							'<span class="mui-col-xs-3">底板检验状况:</span>'+
							'<span class="mui-col-xs-9"><input id="checkResult'+i+'" class="reset" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row ">'+
							'<span class="mui-col-xs-3">操作人:</span>'+
							'<span class="mui-col-xs-9"><input id="operator'+i+'" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row ">'+
							'<span class="mui-col-xs-3">备注:</span>'+
							'<span class="mui-col-xs-9"><input id="remark'+i+'" type="text" value="" /></span>'+
						'</p>'+
						'<p class="mui-row " style="display: none;">'+
							'<span class="mui-col-xs-9"><input id="auditor'+i+'" type="text" value="" /></span>'+
					    '</p>'+
						'</div>'+
						'</li>'+
						'<script>'+
						'layui.laydate.render({'+
					  		'elem: "#upperTime'+i+'",'+
					  		'type: "time",'+
					  		'range:false,'+
					  		'value: new Date(),'+
					  		'format: "HH:mm:ss",'+
					  		'theme: "default",'+
					  		'btns:["now", "confirm"]'+
				  		'});'+
						'layui.laydate.render({'+
					  		'elem: "#lowerTime'+i+'",'+
					  		'type: "time",'+
					  		'range:false,'+
					  		'value: new Date(),'+
					  		'format: "HH:mm:ss",'+
					  		'theme: "default",'+
					  		'btns:["now", "confirm"]'+
				  		'});'+
						'var state = app.getState();'+
						'document.getElementById("operator'+i+'").value = state.username;'+
						'document.getElementById("minHoleDia'+i+'").value = document.getElementById("minHoleDia1").value;'+
						'document.getElementById("plateThick'+i+'").value = document.getElementById("plateThick1").value;'+
						'$(".calc'+i+'").change(function(){'+
		  				'$("#totalNum'+i+'").val($("#laminatea'+i+'").val()*1+$("#laminateb'+i+'").val()*1+'+
		  				'$("#laminatec'+i+'").val()*1+$("#laminated'+i+'").val()*1+$("#laminatee'+i+'").val()*1+$("#laminatef'+i+'").val()*1);'+
		  	  			'});'+
						'<\/script>'
	    );
	    i++;
	  });
	  $("#remove").click(function(){
		  if(i>2){
		    $('#t'+--i).remove();
		  }
	  });
	  $("#operator").change(function(){
		  	$("#operator1").val($("#operator").val());
	  });
	  $("#machineNo").change(function(){
	  	  	$("#machineNo1").val($("#machineNo").val());
	  });
	  $("#class").change(function(){
	  	  	$("#class1").val($("#class").val());
	  });
	  $(".calc").change(function(){
		  $("#totalNum1").val($("#laminatea1").val()*1+$("#laminateb1").val()*1+
		  $("#laminatec1").val()*1+$("#laminated1").val()*1+$("#laminatee1").val()*1+$("#laminatef1").val()*1);
	  });
});

//layui日期控件 
	layui.laydate.render({
		elem: "#upperTime1",
		type: "time",
		range:false,
		value: new Date(),
		format: "HH:mm:ss",
		theme: "default",
		btns:['now', 'confirm']
	});
	layui.laydate.render({
		elem: "#lowerTime1",
		type: "time",
		range:false,
		value: new Date(),
		format: "HH:mm:ss",
		theme: "default",
		btns:['now', 'confirm']
	});

		$(document).ready(function(){
		  $(".reset").on("click",function(){
			  $(this).css("background-color", "");
		  });
		});
		// 表单
		document.getElementById("submit").addEventListener('tap', function() {
			/*var information = {
				machineNo: document.getElementById("machineNo").value || '',
				prodQty: document.getElementById("prodQty").value || '',
				laminatea: document.getElementById("laminatea").value || '',
				laminateb: document.getElementById("laminateb").value || '',
				laminatec: document.getElementById("laminatec").value || '',
				laminated: document.getElementById("laminated").value || '',
				laminatee: document.getElementById("laminatee").value || '',
				laminatef: document.getElementById("laminatef").value || '',
				totalHoleNo: document.getElementById("totalHoleNo").value || '',
				specHoleNo: document.getElementById("specHoleNo").value || '',
				minHoleDia: document.getElementById("minHoleDia").value || '',
				plateThick: document.getElementById("plateThick").value || '',
				totalNum: document.getElementById("totalNum").value || '',
				fisrtConfirm: document.getElementById("fisrtConfirm").value || '',
				checkResult: document.getElementById("checkResult").value || '',
				operator: document.getElementById("operator").value || '',

			}
			if (information.machineNo.length < 1 || information.prodQty.length < 1 ||
				information.laminatea.length < 1 || information.laminateb.length < 1 ||
				information.laminatec.length < 1 || information.laminated.length < 1 ||
				information.laminatee.length < 1 || information.laminatef.length < 1 ||
				information.totalHoleNo.length < 1 || information.specHoleNo.length < 1 ||
				information.minHoleDia.length < 1 || information.plateThick.length < 1 ||
				information.totalNum.length < 1 || information.fisrtConfirm.length < 1 ||
				information.checkResult.length < 1 || information.operator.length < 1) {
				var color = "#F9F900";
				if (information.machineNo.length < 1)
					$("#machineNo").css("background-color", color);
				if (information.prodQty.length < 1)
					$("#prodQty").css("background-color", color);
				if (information.laminatea.length < 1)
					$("#laminatea").css("background-color", color);
				if (information.laminateb.length < 1)
					$("#laminateb").css("background-color", color);
				if (information.laminatec.length < 1)
					$("#laminatec").css("background-color", color);
				if (information.laminated.length < 1)
					$("#laminated").css("background-color", color);
				if (information.laminatee.length < 1)
					$("#laminatee").css("background-color", color);
				if (information.laminatef.length < 1)
					$("#laminatef").css("background-color", color);
				if (information.totalHoleNo.length < 1)
					$("#totalHoleNo").css("background-color", color);
				if (information.specHoleNo.length < 1)
					$("#specHoleNo").css("background-color", color);
				if (information.minHoleDia.length < 1)
					$("#minHoleDia").css("background-color", color);
				if (information.plateThick.length < 1)
					$("#plateThick").css("background-color", color);
				if (information.totalNum.length < 1)
					$("#totalNum").css("background-color", color);
				if (information.fisrtConfirm.length < 1)
					$("#fisrtConfirm").css("background-color", color);
				if (information.checkResult.length < 1)
					$("#checkResult").css("background-color", color);
				if (information.operator.length < 1)
					$("#operator").css("background-color", color);
				plus.nativeUI.toast("黄色区域为必填项！");
				return;
			} else {*/
				if (!confirm("确认提交吗？"))
					return;

				if (document.getElementById("remark1").value.length > 30) {
					mui.alert("备注超过30字");
					return;
				}
				var iscopper;
				var speccut;
				var facarr = {
					'一厂': 1,
					'二厂': 2,
					'三厂': 3,
					'未知': 'N/A'
				}
				factoryName = facarr[document.getElementById("factoryName").value];
				

				// for(var key in data){
				// 	if(data[key] == undefined || data[key] == null || data[key] == ''){
				// 		mui.alert("必填项不能为空");
				// 		return;
				// 	}
				// }
				
				var data = {factoryName: factoryName,
					mo:document.getElementById("mo").value,
					mfg:document.getElementById("mfg").value,
					wo:document.getElementById("wo").value,
					custcode:document.getElementById("custcode").value,
					custpart:document.getElementById("custpart").value,
					lot:document.getElementById("lot").value,
					datecode:document.getElementById("datecode").value,
					d06rkey:document.getElementById("d06rkey").value};
				for(var j = 1;j < i;j++){
					data["machineNo"+j] = document.getElementById("machineNo"+j).value;
					data["class"+j] = document.getElementById("class"+j).value;
					data["laminatea"+j] = document.getElementById("laminatea"+j).value;
					data["laminateb"+j] = document.getElementById("laminateb"+j).value;
					data["laminatec"+j] = document.getElementById("laminatec"+j).value;
					data["laminated"+j] = document.getElementById("laminated"+j).value;
					data["laminatee"+j] = document.getElementById("laminatee"+j).value;
					data["laminatef"+j] = document.getElementById("laminatef"+j).value;
					data["totalHoleNo"+j] = document.getElementById("totalHoleNo"+j).value;
					data["specHoleNo"+j] = document.getElementById("specHoleNo"+j).value;
					data["minHoleDia"+j] = document.getElementById("minHoleDia"+j).value;
					data["plateThick"+j] = document.getElementById("plateThick"+j).value;
					data["totalNum"+j] = document.getElementById("totalNum"+j).value;
					data["upperTime"+j] = document.getElementById("upperTime"+j).innerHTML;
					data["lowerTime"+j] = document.getElementById("lowerTime"+j).innerHTML;
					data["fisrtConfirm"+j] = document.getElementById("fisrtConfirm"+j).value;
					data["checkResult"+j] = document.getElementById("checkResult"+j).value;
					data["operator"+j] = document.getElementById("operator"+j).value;
					data["remark"+j] = document.getElementById("remark"+j).value;
					data["auditor"+j] = document.getElementById("auditor"+j).value;
				}
				var params = JSON.stringify(data);
				mui.ajax({
					url: realapi + '/JOVE_QIS/query/saveVerifyData.action?id=30',
					type: "post",
					data: {
						params: params,
						isRejectItem: false
					},
					dataType: "json",
					async: false,
					error: function() {
						mui.alert("error occur!");
					},
					success: function(data) {
						if (data.isOK) {
							mui.alert("上传成功!");
						} else {
							mui.alert("未知错误。");
						}
						$(".reset").val("");
						$(".reset").css("background-color", "");
						$(".tiaoMa input[type='text']").val("");
					}
				});
			});
		

		(function($, doc) {
			//初始化 scan页
			$.init({
				preloadPages: [{
					id: 'scan.html',
					url: '../scan.html'
				}]
			});

			document.querySelector("input[data-id='tiaoma1']").onchange = function() {
				var qrdata = document.getElementById("code").value;
				// 采集数据
				mui.ajax(realapi + '/JOVE_QIS/query/queryCommonDataByWO.action?id=2', {
					data: {
						wo: qrdata,
						isControl: false
					},
					dataType: 'json', //服务器返回json格式数据
					type: 'post', //HTTP请求类型
					timeout: 3000, //超时时间设置为10秒；
					success: function(data) {
						if (data.success) {
							// 基础信息
							document.getElementById("mo").value = data.app.mo;
							document.getElementById("wo").value = data.app.wo;
							document.getElementById("mfg").value = data.app.mfg;
							document.getElementById("custcode").value = data.app.cust_code;
							document.getElementById("custpart").value = data.app.pn;
							document.getElementById("lot").value = data.app.lot;
							document.getElementById("datecode").value = data.app.datecode;
							document.getElementById("d06rkey").value = data.app.d06rkey;

							jQuery(".minHoleDia").val(data.app.minholesize);
							jQuery(".plateThick").val(data.app.platethickness);
						} else {
							mui.alert(data.mess);
						}
					},
					error: function(xhr, type, errorThrown) {
						//异常处理
						if (type == "timeout")
							$.toast('连接超时，请检查网络')

						$.toast('系统异常，请检查是否连接jove-wifi')
					}
				})
			}

			//自定义事件,供扫描回调
			window.addEventListener('getScan', function(event) {
				// 获得事件参数
				// var id = event.detail.id;
				qrtype = event.detail.qrtype;
				qrdata = event.detail.qrdata;
				// 赋值到输入框
				if (qrtype && qrdata) {
					// mui.alert(qrtype + ":" + qrdata );
					var arr = qrdata.split(',');
					if (arr.length > 2) {
						qrdata = arr[1];
					}
					document.querySelector("input[data-id='" + qrtype + "']").value = qrdata;

					if (qrtype == 'tiaoma') {
						// 采集数据
						mui.ajax(realapi + '/JOVE_QIS/query/queryCommonDataByWO.action?id=2', {
							data: {
								wo: qrdata,
								isControl: false
							},
							dataType: 'json', //服务器返回json格式数据
							type: 'POST', //HTTP请求类型
							timeout: 3000, //超时时间设置为10秒；
							success: function(data) {
								if (data.success) {
									// 基础信息
									document.getElementById("mo").value = data.app.mo;
									document.getElementById("wo").value = data.app.wo;
									document.getElementById("mfg").value = data.app.mfg;
									document.getElementById("custcode").value = data.app.cust_code;
									document.getElementById("custpart").value = data.app.pn;
									document.getElementById("lot").value = data.app.lot;
									document.getElementById("datecode").value = data.app.datecode;
									document.getElementById("d06rkey").value = data.app.d06rkey;

									document.getElementById("prodQty").value = data.app.quanpanel;
								} else {
									mui.alert(data.mess);
								}
							},
							error: function(xhr, type, errorThrown) {
								//异常处理
								if (type == "timeout")
									$.toast('连接超时，请检查网络')

								$.toast('系统异常，请检查是否连接jove-wifi')
							}
						})
					}

					if (qrtype == 'bancai') {
						var val = qrdata.trim().split(",");
						if (val.length != 11) {
							//板材二维码规格：供应商名称,料号,批次号,数量,尺寸,规格,生产日期,是否含铜,板厚,铜厚,TG值
							mui.toast("板材条码错误");
						} else {
							document.getElementById("supppn").value = val[5];
							document.getElementById("plateply").value = val[8];
							document.getElementById("copperply").value = val[9];
						}
					}
				}
			});

			$.plusReady(function() {
				// 获取本页面的固定信息
				var self = plus.webview.currentWebview();

				// 扫描页webview
				var scanPage = null;
				document.querySelectorAll(".scan").forEach(function(el) {
					el.addEventListener('tap', function() {
						// 扫描页webview
						if (!scanPage) {
							scanPage = plus.webview.getWebviewById('scan.html');
						}
						// 这里只有qrtype 是不一样的,根据el来
						var qrtype = el.getAttribute("data-id");
						mui.fire(scanPage, 'newScan', {
							qrtype: qrtype,
							source: self.openurl,
							sourceid: self.id
						});
						mui.openWindow({
							id: 'scan.html'
						});
					})
				})

				// 登录状态消息
				var state = app.getState();
				document.getElementById("factoryName").value = state.changbie;
				document.getElementById("operator1").value = state.username;

				// 日期控件
				/*function pad(num, n) {
					var len = num.toString().length;
					while (len < n) {
						num = "0" + num;
						len++;
					}
					return num;
				}
				var date = new Date();
				var pickerf = function() {
					var _self = this;
					if (_self.picker) {
						_self.picker.show(function(rs) {
							_self.innerHTML = rs.text;
							_self.picker.dispose();
							_self.picker = null;
						});
					} else {
						var current = date.getFullYear() + "-" + pad((date.getMonth() + 1).toString(), 2) + "-" + pad(date.getDate(),
							2);
						current += " " + pad(date.getHours(), 2) + ":" + pad(date.getMinutes(), 2);
						var options = {
							"value": current,
							"beginYear": 2019,
							"endYear": 2038
						};
						console.log("当前时间:" + current);
						var id = this.getAttribute('id');
				
						_self.picker = new $.DtPicker(options);
						_self.picker.show(function(rs) {
							_self.innerHTML = rs.text;
							_self.picker.dispose();
							_self.picker = null;
						});
					}
				}
				document.getElementById("upperTime1").addEventListener('tap', pickerf);
				document.getElementById("lowerTime1").addEventListener('tap', pickerf);
				var current = date.getFullYear() + "-" + pad((date.getMonth() + 1).toString(), 2) + "-" + pad(date.getDate(), 2);
				current += " " + pad(date.getHours(), 2) + ":" + pad(date.getMinutes(), 2);
				document.getElementById("upperTime1").innerHTML = current;
				document.getElementById("lowerTime1").innerHTML = current;*/



				document.getElementById("reset").addEventListener('tap', function() {
					if (!confirm("确认重置吗？"))
						return;

					document.querySelectorAll(".tiaoMa input[type='text']").forEach(function(el) {
						el.value = '';
					})
					document.querySelectorAll(".reset").forEach(function(el) {
						el.value = '';
					})
					document.querySelectorAll(".shiceshuju .reset").forEach(function(el) {
						el.innerHTML = '';
					})
					document.querySelectorAll(".shiceshuju input[type='radio']").forEach(function(el) {
						el.checked = '';
					})
					document.querySelectorAll(".shiceshuju input[type='checkbox']").forEach(function(el) {
						el.checked = '';
					})
					document.querySelector("input[value='无不良']").checked = 'checked';
				});

			});
		}(mui, document));
	</script>
</html>
